(function(){var now = { row:1, col:1 }, last = { row:0, col:0}, isAnimating = false; const towards = { up:1, right:2, down:3, left:4}; document.addEventListener('touchmove',function(e){e.preventDefault();},{passive:false}); /*// 上下滑动*/ $(document).swipeUp(function(){if (isAnimating) return; if (isopen == false) return; last.row = now.row; last.col = now.col; if (last.row != pagecount) { now.row = last.row+1; now.col = 1; pageMove(towards.up);} else {now.row = 1; now.col = 1; last.row = pagecount; pageMove(towards.up); } img_load(now.row); }); $(document).swipeDown(function(){if (isAnimating) return; if (isopen == false) return; last.row = now.row; last.col = now.col; if (last.row!=1) { now.row = last.row-1; now.col = 1; pageMove(towards.down);} }); /*// 左右滑动 // $(document).swipeLeft(function(){// 	if (isAnimating) return; // 	last.row = now.row; // 	last.col = now.col; // 	if (last.row>1 && last.row<5 && last.col==1) { now.row = last.row; now.col = 2; pageMove(towards.left);} // }) // //$(document).swipeRight(function(){//	if (isAnimating) return; //	last.row = now.row; //	last.col = now.col; //	if (last.row>1 && last.row<5 && last.col==2) { now.row = last.row; now.col = 1; pageMove(towards.right);} //})*/ /* 图片异步加载 page_id 当前页ID(必选) position 当前页相对定位（可选） number 图片加载页数（可选） */ function img_load(page_id,position,number){if(position){page_id = page_id-position;} if(number){loop = number;}else{loop = 2;} for(var s=1;s<=loop;s++){page_id++; var page = $(".page-"+page_id+"-1 img"), length = page.length; for(var i=0;i<=length;i++){var data_src = page.eq(i).attr("data_src"); if(data_src){page.eq(i).attr("src",data_src); } } } } function pageMove(tw){var lastPage = ".page-"+last.row+"-"+last.col, nowPage = ".page-"+now.row+"-"+now.col; switch(tw) {case towards.up: outClass = 'pt-page-moveToTop'; inClass = 'pt-page-moveFromBottom'; break; case towards.right: outClass = 'pt-page-moveToRight'; inClass = 'pt-page-moveFromLeft'; break; case towards.down: outClass = 'pt-page-moveToBottom'; inClass = 'pt-page-moveFromTop'; break; case towards.left: outClass = 'pt-page-moveToLeft'; inClass = 'pt-page-moveFromRight'; break; } isAnimating = true; $(nowPage).removeClass("hide"); $(lastPage).addClass(outClass); $(nowPage).addClass(inClass); setTimeout(function(){$(lastPage).removeClass('page-current'); $(lastPage).removeClass(outClass); $(lastPage).addClass("hide"); /*//$(lastPage).find("img").addClass("hide");*/ $(nowPage).addClass('page-current'); $(nowPage).removeClass(inClass); /*//$(nowPage).find("img").removeClass("hide");*/ isAnimating = false; },1500); } })();